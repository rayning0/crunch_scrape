require 'spec_helper'

describe NYCompanies do
  before do
    @companies = NYCompanies.new
  end

  describe "#get_ny_companies (unit test)" do
    it "returns Viacom, since it's in New York" do
      company = double(:company) 
      company.stub(body: "{\"name\": \"Viacom\",\n \"permalink\": \"viacom\",\n \"crunchbase_url\": \"http://www.crunchbase.com/company/viacom\",\n \"homepage_url\": \"http://www.viacom.com\",\n \"blog_url\": \"\",\n \"blog_feed_url\": \"\",\n \"twitter_username\": \"viacom\",\n \"category_code\": \"web\",\n \"number_of_employees\": null,\n \"founded_year\": 1971,\n \"founded_month\": null,\n \"founded_day\": null,\n \"deadpooled_year\": null,\n \"deadpooled_month\": null,\n \"deadpooled_day\": null,\n \"deadpooled_url\": null,\n \"tag_list\": null,\n \"alias_list\": \"CBS\",\n \"email_address\": \"\",\n \"phone_number\": \"(212) 258-6000\",\n \"description\": \"TV production\",\n \"created_at\": \"Sat Jun 09 07:30:15 UTC 2007\",\n \"updated_at\": \"Mon Apr 15 12:51:12 UTC 2013\",\n \"overview\": \"\\u003Cp\\u003EViacom, short for \\u0026#8220;Video \\u0026amp; Audio Communications\\u0026#8221;, is an American media conglomerate with various worldwide interests in cable and satellite television networks (\\u003Ca href=\\\"/company/mtv-networks\\\" title=\\\"MTV Networks\\\" rel=\\\"nofollow\\\"\\u003EMTV Networks\\u003C/a\\u003E and BET), and movie production and distribution with \\u003Ca href=\\\"/company/paramount-pictures\\\" title=\\\"Paramount Motion Pictures Group.\\\" rel=\\\"nofollow\\\"\\u003EParamount Motion Pictures Group.\\u003C/a\\u003E\\u003C/p\\u003E\\n\\n\\u003Cp\\u003EThe new Viacom conglomerate was finalized in September of 2006 is considered to be the \\u0026#8220;high-growth\\u0026#8221; side of the much larger former Viacom. The former Viacom was renamed \\u003Ca href=\\\"/company/cbs\\\" title=\\\"CBS Corporation\\\" rel=\\\"nofollow\\\"\\u003ECBS Corporation\\u003C/a\\u003E, from which this firm was split off on December 31, 2005.\\u003C/p\\u003E\",\n \"image\":\n  {\"available_sizes\":\n    [[[150,\n       34],\n      \"assets/images/resized/0001/6891/16891v1-max-150x150.png\"],\n     [[158,\n       36],\n      \"assets/images/resized/0001/6891/16891v1-max-250x250.png\"],\n     [[158,\n       36],\n      \"assets/images/resized/0001/6891/16891v1-max-450x450.png\"]],\n   \"attribution\": null},\n \"products\":\n  [],\n \"relationships\":\n  [{\"is_past\": false,\n    \"title\": \"President, CEO\",\n    \"person\":\n     {\"first_name\": \"Philippe\",\n      \"last_name\": \"Dauman\",\n      \"permalink\": \"philippe-dauman\"}},\n   {\"is_past\": false,\n    \"title\": \"Senior Exec. VP, Chief Admin. Officer, CFO\",\n    \"person\":\n     {\"first_name\": \"Thomas\",\n      \"last_name\": \"Dooley\",\n      \"permalink\": \"thomas-dooley\"}},\n   {\"is_past\": false,\n    \"title\": \"VP, Business Development\",\n    \"person\":\n     {\"first_name\": \"Scott\",\n      \"last_name\": \"Saperstein\",\n      \"permalink\": \"scott-saperstein\"}},\n   {\"is_past\": false,\n    \"title\": \"SVP, Strategy, Mergers and Acquisitions\",\n    \"person\":\n     {\"first_name\": \"Wade\",\n      \"last_name\": \"Davis\",\n      \"permalink\": \"wade-davis\"}},\n   {\"is_past\": false,\n    \"title\": \"SVP \\u0026 GM, Digital Media at MTV Networks\",\n    \"person\":\n     {\"first_name\": \"Michael\",\n      \"last_name\": \"Bloom\",\n      \"permalink\": \"michael-bloom\"}},\n   {\"is_past\": false,\n    \"title\": \"EVP, Controller, Tax and Treasury\",\n    \"person\":\n     {\"first_name\": \"James\",\n      \"last_name\": \"Barge\",\n      \"permalink\": \"james-barge\"}},\n   {\"is_past\": false,\n    \"title\": \"Board of Directors\",\n    \"person\":\n     {\"first_name\": \"Charles\",\n      \"last_name\": \"Phillips\",\n      \"permalink\": \"charles-phillips\"}},\n   {\"is_past\": false,\n    \"title\": \"Various Role\",\n    \"person\":\n     {\"first_name\": \"Richard\",\n      \"last_name\": \"P. Ramirez\",\n      \"permalink\": \"richard-p-ramirez\"}},\n   {\"is_past\": false,\n    \"title\": \"VP, AddictingGames\",\n    \"person\":\n     {\"first_name\": \"John\",\n      \"last_name\": \"vanSuchtelen\",\n      \"permalink\": \"john-vansuchtelen\"}},\n   {\"is_past\": false,\n    \"title\": \"Board of Directors\",\n    \"person\":\n     {\"first_name\": \"Frederic\",\n      \"last_name\": \"V. Salerno\",\n      \"permalink\": \"frederic-v-salerno\"}},\n   {\"is_past\": false,\n    \"title\": \"Senior Executive\",\n    \"person\":\n     {\"first_name\": \"Fredric\",\n      \"last_name\": \"G. Reynolds\",\n      \"permalink\": \"fredric-g-reynolds\"}},\n   {\"is_past\": true,\n    \"title\": \"COO, EVP MTVN Ad Sales\",\n    \"person\":\n     {\"first_name\": \"Carolyn\",\n      \"last_name\": \"Everson\",\n      \"permalink\": \"carolyn-everson\"}},\n   {\"is_past\": true,\n    \"title\": \"CFO\",\n    \"person\":\n     {\"first_name\": \"Mike\",\n      \"last_name\": \"Majors\",\n      \"permalink\": \"mike-majors\"}},\n   {\"is_past\": true,\n    \"title\": \"CIO\",\n    \"person\":\n     {\"first_name\": \"Joe\",\n      \"last_name\": \"Simon\",\n      \"permalink\": \"joe-simon\"}},\n   {\"is_past\": true,\n    \"title\": \"CTO \\u0026 VP, Social Media and Community\",\n    \"person\":\n     {\"first_name\": \"Alex\",\n      \"last_name\": \"Karelin\",\n      \"permalink\": \"alex-karelin\"}},\n   {\"is_past\": true,\n    \"title\": \"Co - President / Co - COO\",\n    \"person\":\n     {\"first_name\": \"Leslie\",\n      \"last_name\": \"Moonves\",\n      \"permalink\": \"leslie-moonves\"}},\n   {\"is_past\": true,\n    \"title\": \"VP Viacom International\",\n    \"person\":\n     {\"first_name\": \"Dwight\",\n      \"last_name\": \"Tierney\",\n      \"permalink\": \"dwight-tierney\"}},\n   {\"is_past\": true,\n    \"title\": \"SVP, Advertising Sales \\u0026 Partnership Marketing\",\n    \"person\":\n     {\"first_name\": \"David\",\n      \"last_name\": \"Kohl\",\n      \"permalink\": \"david-kohl\"}},\n   {\"is_past\": true,\n    \"title\": \"VP, Corporate Finance\",\n    \"person\":\n     {\"first_name\": \"Nick\",\n      \"last_name\": \"Stoumpas\",\n      \"permalink\": \"nick-stoumpas\"}},\n   {\"is_past\": true,\n    \"title\": \"Senior Vice Presiden\",\n    \"person\":\n     {\"first_name\": \"Dennis\",\n      \"last_name\": \"Defensor\",\n      \"permalink\": \"dennis-defensor\"}},\n   {\"is_past\": true,\n    \"title\": \"\",\n    \"person\":\n     {\"first_name\": \"Tom\",\n      \"last_name\": \"Freston\",\n      \"permalink\": \"tom-freston\"}},\n   {\"is_past\": true,\n    \"title\": \"Sr. UNIX Systems Engineer\",\n    \"person\":\n     {\"first_name\": \"Jamieson\",\n      \"last_name\": \"Becker\",\n      \"permalink\": \"jamieson-becker\"}},\n   {\"is_past\": true,\n    \"title\": \"Marketing Consultant/Ad Salesperson\",\n    \"person\":\n     {\"first_name\": \"Bradford\",\n      \"last_name\": \"Shane Shellhammer\",\n      \"permalink\": \"bradford-shane-shellhammer\"}},\n   {\"is_past\": true,\n    \"title\": \"Board Director\",\n    \"person\":\n     {\"first_name\": \"Patricia Q.\",\n      \"last_name\": \"Stonesifer\",\n      \"permalink\": \"patricia-q-stonesifer\"}},\n   {\"is_past\": true,\n    \"title\": \"Senior Account Director\",\n    \"person\":\n     {\"first_name\": \"Daizo\",\n      \"last_name\": \"Nishitani\",\n      \"permalink\": \"daizo-nishitani\"}},\n   {\"is_past\": true,\n    \"title\": \"Senior Advisor\",\n    \"person\":\n     {\"first_name\": \"Jonathan\",\n      \"last_name\": \"L. Dolgen\",\n      \"permalink\": \"jonathan-l-dolgen\"}},\n   {\"is_past\": true,\n    \"title\": \"President\",\n    \"person\":\n     {\"first_name\": \"Gerry\",\n      \"last_name\": \"Laybourne\",\n      \"permalink\": \"geraldine-b-laybourne\"}},\n   {\"is_past\": true,\n    \"title\": \"Senior Attorney\",\n    \"person\":\n     {\"first_name\": \"Lisa\",\n      \"last_name\": \"A. Hook\",\n      \"permalink\": \"lisa-a-hook-2\"}},\n   {\"is_past\": true,\n    \"title\": \"Financial Planning Manager\",\n    \"person\":\n     {\"first_name\": \"Hugh\",\n      \"last_name\": \"Crean\",\n      \"permalink\": \"hugh-crean-2\"}},\n   {\"is_past\": true,\n    \"title\": \"Director\",\n    \"person\":\n     {\"first_name\": \"John\",\n      \"last_name\": \"Papola\",\n      \"permalink\": \"john-papola\"}},\n   {\"is_past\": true,\n    \"title\": \"Flash Developer\",\n    \"person\":\n     {\"first_name\": \"Mugur\",\n      \"last_name\": \"Marculescu\",\n      \"permalink\": \"mugur-marculescu\"}},\n   {\"is_past\": true,\n    \"title\": \"Head, Pricing \\u0026 Inventory group - Kids \\u0026 Family Div.\",\n    \"person\":\n     {\"first_name\": \"Rebecca\",\n      \"last_name\": \"Trowbridge Claffey\",\n      \"permalink\": \"rebecca-trowbridge-claffey\"}},\n   {\"is_past\": true,\n    \"title\": \"\",\n    \"person\":\n     {\"first_name\": \"Joel\",\n      \"last_name\": \"Andryc\",\n      \"permalink\": \"joel-andryc\"}},\n   {\"is_past\": true,\n    \"title\": \"Team Leader - Sales \\u0026 Client Services\",\n    \"person\":\n     {\"first_name\": \"Ivan\",\n      \"last_name\": \"Lenev\",\n      \"permalink\": \"ivan-lenev\"}},\n   {\"is_past\": true,\n    \"title\": \"Business Development, New Media\",\n    \"person\":\n     {\"first_name\": \"Eugene\",\n      \"last_name\": \"Evans\",\n      \"permalink\": \"eugene-evans\"}},\n   {\"is_past\": true,\n    \"title\": \"\",\n    \"person\":\n     {\"first_name\": \"Hugh\",\n      \"last_name\": \"Crean\",\n      \"permalink\": \"hugh-crean\"}},\n   {\"is_past\": true,\n    \"title\": \"Producer\",\n    \"person\":\n     {\"first_name\": \"Robert\",\n      \"last_name\": \"Lasky\",\n      \"permalink\": \"robert-lasky\"}},\n   {\"is_past\": true,\n    \"title\": \"V.P. Marketing \\u0026 Recreation\",\n    \"person\":\n     {\"first_name\": \"Carlos\",\n      \"last_name\": \"Tribino\",\n      \"permalink\": \"carlos-tribino\"}},\n   {\"is_past\": true,\n    \"title\": \"Director, Viacom Plus, Western Region\",\n    \"person\":\n     {\"first_name\": \"Jodi\",\n      \"last_name\": \"Lipe\",\n      \"permalink\": \"jodi-lipe\"}},\n   {\"is_past\": true,\n    \"title\": \"EVP of Sales | Senior Advisor\",\n    \"person\":\n     {\"first_name\": \"Doug\",\n      \"last_name\": \"Rohrer\",\n      \"permalink\": \"doug-rohrer-2\"}},\n   {\"is_past\": true,\n    \"title\": \"Strategic Consultant\",\n    \"person\":\n     {\"first_name\": \"Alec\",\n      \"last_name\": \"Andronikov\",\n      \"permalink\": \"alec-andronikov\"}},\n   {\"is_past\": true,\n    \"title\": \"Summer Associate\",\n    \"person\":\n     {\"first_name\": \"TOCCARA\",\n      \"last_name\": \"BAKER\",\n      \"permalink\": \"toccara-baker\"}},\n   {\"is_past\": true,\n    \"title\": \"Manager, Market Development\",\n    \"person\":\n     {\"first_name\": \"Alec\",\n      \"last_name\": \"Newcomb\",\n      \"permalink\": \"alec-newcomb\"}},\n   {\"is_past\": true,\n    \"title\": \"Account Executive\",\n    \"person\":\n     {\"first_name\": \"John\",\n      \"last_name\": \"Livett\",\n      \"permalink\": \"john-livett\"}},\n   {\"is_past\": true,\n    \"title\": \"Web Developer\",\n    \"person\":\n     {\"first_name\": \"Mugur\",\n      \"last_name\": \"Marculescu\",\n      \"permalink\": \"mugur-marculescu\"}},\n   {\"is_past\": true,\n    \"title\": \"\",\n    \"person\":\n     {\"first_name\": \"Roger\",\n      \"last_name\": \"Pavane\",\n      \"permalink\": \"roger-pavane\"}},\n   {\"is_past\": true,\n    \"title\": \"\",\n    \"person\":\n     {\"first_name\": \"Donna\",\n      \"last_name\": \"Granato\",\n      \"permalink\": \"donna-granato\"}},\n   {\"is_past\": true,\n    \"title\": \"Member of Executive Committe\",\n    \"person\":\n     {\"first_name\": \"Jonathan\",\n      \"last_name\": \"Newcomb\",\n      \"permalink\": \"jonathan-newcomb\"}},\n   {\"is_past\": true,\n    \"title\": \"\",\n    \"person\":\n     {\"first_name\": \"Oscar\",\n      \"last_name\": \"Marin\",\n      \"permalink\": \"oscar-marin\"}}],\n \"competitions\":\n  [],\n \"providerships\":\n  [{\"title\": \"web/application design\",\n    \"is_past\": false,\n    \"provider\":\n     {\"name\": \"twothirty\",\n      \"permalink\": \"twothirty\"}},\n   {\"title\": \"\",\n    \"is_past\": false,\n    \"provider\":\n     {\"name\": \"MotiveQuest\",\n      \"permalink\": \"motivequest\"}}],\n \"total_money_raised\": \"$0\",\n \"funding_rounds\":\n  [],\n \"investments\":\n  [{\"funding_round\":\n     {\"round_code\": \"b\",\n      \"source_url\": \"http://www.techcrunch.com/2007/01/16/tagworld-deadpool-or-success/\",\n      \"source_description\": null,\n      \"raised_amount\": 40000000.0,\n      \"raised_currency_code\": \"USD\",\n      \"funded_year\": 2006,\n      \"funded_month\": 12,\n      \"funded_day\": 1,\n      \"company\":\n       {\"name\": \"Social Project\",\n        \"permalink\": \"social-project\"}}},\n   {\"funding_round\":\n     {\"round_code\": \"unattributed\",\n      \"source_url\": \"http://www.prnewswire.com/news-releases/viacom-invests-in-rainbow-group-115262554.html?utm_source=twitterfeed\\u0026utm_medium=twitter\",\n      \"source_description\": \"Viacom Invests in Rainbow Group\",\n      \"raised_amount\": null,\n      \"raised_currency_code\": null,\n      \"funded_year\": 2011,\n      \"funded_month\": 2,\n      \"funded_day\": 4,\n      \"company\":\n       {\"name\": \"Rainbow\",\n        \"permalink\": \"rainbow\"}}}],\n \"acquisition\": null,\n \"acquisitions\":\n  [{\"price_amount\": 64000000.0,\n    \"price_currency_code\": \"USD\",\n    \"term_code\": \"cash\",\n    \"source_url\": null,\n    \"source_description\": null,\n    \"acquired_year\": 2004,\n    \"acquired_month\": 12,\n    \"acquired_day\": 1,\n    \"company\":\n     {\"name\": \"Sportsline\",\n      \"permalink\": \"sportsline\"}},\n   {\"price_amount\": null,\n    \"price_currency_code\": \"USD\",\n    \"term_code\": \"cash\",\n    \"source_url\": \"\",\n    \"source_description\": \"\",\n    \"acquired_year\": 2006,\n    \"acquired_month\": 8,\n    \"acquired_day\": 1,\n    \"company\":\n     {\"name\": \"Y2M\",\n      \"permalink\": \"y2m\"}},\n   {\"price_amount\": 102000000.0,\n    \"price_currency_code\": \"USD\",\n    \"term_code\": \"cash\",\n    \"source_url\": \"http://www.gamespot.com/news/6148208.html\",\n    \"source_description\": \"Media giant offers $102 million in cash for online gaming utility company; makes it part of MTV Networks.\",\n    \"acquired_year\": 2006,\n    \"acquired_month\": 4,\n    \"acquired_day\": 1,\n    \"company\":\n     {\"name\": \"Xfire\",\n      \"permalink\": \"xfire\"}},\n   {\"price_amount\": null,\n    \"price_currency_code\": \"USD\",\n    \"term_code\": null,\n    \"source_url\": \"\",\n    \"source_description\": \"press release\",\n    \"acquired_year\": 2008,\n    \"acquired_month\": 9,\n    \"acquired_day\": 22,\n    \"company\":\n     {\"name\": \"Social Project\",\n      \"permalink\": \"social-project\"}},\n   {\"price_amount\": null,\n    \"price_currency_code\": \"USD\",\n    \"term_code\": null,\n    \"source_url\": \"http://en.wikipedia.org/wiki/MTV_Networks\",\n    \"source_description\": \"MTV Networks\",\n    \"acquired_year\": 1986,\n    \"acquired_month\": null,\n    \"acquired_day\": null,\n    \"company\":\n     {\"name\": \"MTV Networks\",\n      \"permalink\": \"mtv-networks\"}},\n   {\"price_amount\": 10000000000.0,\n    \"price_currency_code\": \"USD\",\n    \"term_code\": \"cash_and_stock\",\n    \"source_url\": \"http://www.nytimes.com/1995/05/03/business/company-reports-viacom-reports-a-net-profit-in-first-quarter.html\",\n    \"source_description\": \"COMPANY REPORTS; Viacom Reports a Net Profit in First Quarter\",\n    \"acquired_year\": 1993,\n    \"acquired_month\": 3,\n    \"acquired_day\": null,\n    \"company\":\n     {\"name\": \"Paramount Pictures\",\n      \"permalink\": \"paramount-pictures\"}}],\n \"offices\":\n  [{\"description\": \"HQ\",\n    \"address1\": \"1515 Broadway\",\n    \"address2\": \"\",\n    \"zip_code\": \"10036\",\n    \"city\": \"New York\",\n    \"state_code\": \"NY\",\n    \"country_code\": \"USA\",\n    \"latitude\": 40.757725,\n    \"longitude\": -73.986011}],\n \"milestones\":\n  [{\"id\": 9983,\n    \"description\": \"Harmonix Music System Inc. is up for sale from its parent company Viacom Inc.\",\n    \"stoned_year\": 2010,\n    \"stoned_month\": 11,\n    \"stoned_day\": 11,\n    \"source_url\": \"http://www.masshightech.com/stories/2010/11/08/daily41-Viacom-selling-Harmonix.html\",\n    \"source_text\": null,\n    \"source_description\": \"Viacom selling Harmonix\",\n    \"stoneable_type\": \"Company\",\n    \"stoned_value\": null,\n    \"stoned_value_type\": null,\n    \"stoned_acquirer\": null,\n    \"stoneable\":\n     {\"name\": \"Viacom\",\n      \"permalink\": \"viacom\"}},\n   {\"id\": 11091,\n    \"description\": \"Harmonix sold to PE firm, goes private\",\n    \"stoned_year\": 2010,\n    \"stoned_month\": 12,\n    \"stoned_day\": 23,\n    \"source_url\": \"http://www.masshightech.com/stories/2010/12/20/daily53-Harmonix-sold-to-PE-firm-goes-private.html\",\n    \"source_text\": \"\",\n    \"source_description\": \"Harmonix sold to PE firm, goes private\",\n    \"stoneable_type\": \"Company\",\n    \"stoned_value\": null,\n    \"stoned_value_type\": null,\n    \"stoned_acquirer\": null,\n    \"stoneable\":\n     {\"name\": \"Viacom\",\n      \"permalink\": \"viacom\"}}],\n \"ipo\":\n  {\"valuation_amount\": null,\n   \"valuation_currency_code\": \"USD\",\n   \"pub_year\": null,\n   \"pub_month\": null,\n   \"pub_day\": null,\n   \"stock_symbol\": \"NYSE:VIA\"},\n \"video_embeds\":\n  [{\"embed_code\": \"\\u003Cembed src=\\\"http://blip.tv/play/hRaXtnsA\\\" type=\\\"application/x-shockwave-flash\\\" width=\\\"370\\\" height=\\\"240\\\" allowscriptaccess=\\\"always\\\" allowfullscreen=\\\"true\\\"\\u003E\\u003C/embed\\u003E\",\n    \"description\": \"\\u003Cp\\u003EThis video was originally published on \\u003Ca href=\\\"http://www.beet.tv/2007/09/viacom-mash-ups.html\\\" title=\\\"Beet.TV\\\" rel=\\\"nofollow\\\"\\u003EBeet.TV\\u003C/a\\u003E\\u003C/p\\u003E\"},\n   {\"embed_code\": \"\\u003Ciframe src=\\\"http://blip.tv/play/goRrg4j0CAI.x?p=1\\\" width=\\\"370\\\" height=\\\"240\\\" frameborder=\\\"0\\\" allowfullscreen\\u003E\\u003C/iframe\\u003E\\u003Cembed type=\\\"application/x-shockwave-flash\\\" src=\\\"http://a.blip.tv/api.swf#goRrg4j0CAI\\\" style=\\\"display:none\\\"\\u003E\\u003C/embed\\u003E\",\n    \"description\": \"\\u003Cp\\u003EThis video was originally published on \\u003Ca href=\\\"http://www.beet.tv/2012/11/vh1-program.html\\\" title=\\\"Beet.TV\\\" rel=\\\"nofollow\\\"\\u003EBeet.TV\\u003C/a\\u003E\\u003C/p\\u003E\"},\n   {\"embed_code\": \"\\u003Ciframe src=\\\"http://blip.tv/play/goRrg4mxGAI.x?p=1\\\" width=\\\"370\\\" height=\\\"240\\\" frameborder=\\\"0\\\" allowfullscreen\\u003E\\u003C/iframe\\u003E\\u003Cembed type=\\\"application/x-shockwave-flash\\\" src=\\\"http://a.blip.tv/api.swf#goRrg4mxGAI\\\" style=\\\"display:none\\\"\\u003E\\u003C/embed\\u003E\",\n    \"description\": \"\\u003Cp\\u003EThis video was originally published on \\u003Ca href=\\\"http://www.beet.tv/2012/11/viacom-millenials.html\\\" title=\\\"Beet.TV\\\" rel=\\\"nofollow\\\"\\u003EBeet.TV\\u003C/a\\u003E\\u003C/p\\u003E\"}],\n \"screenshots\":\n  [{\"available_sizes\":\n     [[[150,\n        115],\n       \"assets/images/resized/0005/6979/56979v1-max-150x150.jpg\"],\n      [[250,\n        192],\n       \"assets/images/resized/0005/6979/56979v1-max-250x250.jpg\"],\n      [[450,\n        347],\n       \"assets/images/resized/0005/6979/56979v1-max-450x450.jpg\"]],\n    \"attribution\": null}],\n \"external_links\":\n  [],\n \"partners\":\n  []}")

      Net::HTTP.stub(:get_response).and_return(company)
      ny_companies = @companies.get_ny_companies(['viacom'])
      expect(ny_companies).to eq([@companies.csv_hash(JSON.parse(company.body))])
    end

    it "doesn't return McDonald's, since it's NOT in New York" do
      company = double(:company) 
      company.stub(body: "{\"name\": \"McDonald's\",\n \"permalink\": \"mcdonalds\",\n \"crunchbase_url\": \"http://www.crunchbase.com/company/mcdonalds\",\n \"homepage_url\": \"http://www.mcdonalds.com\",\n \"blog_url\": \"\",\n \"blog_feed_url\": \"\",\n \"twitter_username\": \"McDonaldsCorp\",\n \"category_code\": \"hospitality\",\n \"number_of_employees\": null,\n \"founded_year\": 1955,\n \"founded_month\": null,\n \"founded_day\": null,\n \"deadpooled_year\": null,\n \"deadpooled_month\": null,\n \"deadpooled_day\": null,\n \"deadpooled_url\": null,\n \"tag_list\": null,\n \"alias_list\": \"\",\n \"email_address\": \"\",\n \"phone_number\": \"\",\n \"description\": \"Fast Food Hamburger Chain\",\n \"created_at\": \"Sun Aug 15 21:16:43 UTC 2010\",\n \"updated_at\": \"Mon Dec 30 17:08:46 UTC 2013\",\n \"overview\": null,\n \"image\":\n  {\"available_sizes\":\n    [[[97,\n       93],\n      \"assets/images/resized/0018/7515/187515v2-max-150x150.png\"],\n     [[97,\n       93],\n      \"assets/images/resized/0018/7515/187515v2-max-250x250.png\"],\n     [[97,\n       93],\n      \"assets/images/resized/0018/7515/187515v2-max-450x450.png\"]],\n   \"attribution\": null},\n \"products\":\n  [],\n \"relationships\":\n  [{\"is_past\": false,\n    \"title\": \"Executive Vice President\",\n    \"person\":\n     {\"first_name\": \"Jeffrey\",\n      \"last_name\": \"B. Kindler\",\n      \"permalink\": \"jeffrey-b-kindler\"}},\n   {\"is_past\": false,\n    \"title\": \"Director\",\n    \"person\":\n     {\"first_name\": \"Susan\",\n      \"last_name\": \"Arnold\",\n      \"permalink\": \"susan-arnold\"}},\n   {\"is_past\": false,\n    \"title\": \"Director\",\n    \"person\":\n     {\"first_name\": \"Robert\",\n      \"last_name\": \"A. Eckert\",\n      \"permalink\": \"robert-a-eckert\"}},\n   {\"is_past\": true,\n    \"title\": \"Sales Assistant\",\n    \"person\":\n     {\"first_name\": \"Gavin\",\n      \"last_name\": \"Ward\",\n      \"permalink\": \"gavin-wardblawg-ward\"}},\n   {\"is_past\": true,\n    \"title\": \"Investor\",\n    \"person\":\n     {\"first_name\": \"John\",\n      \"last_name\": \"Johnston\",\n      \"permalink\": \"john-johnston\"}},\n   {\"is_past\": true,\n    \"title\": \"Executive\",\n    \"person\":\n     {\"first_name\": \"Greg\",\n      \"last_name\": \"Wood\",\n      \"permalink\": \"greg-wood\"}},\n   {\"is_past\": true,\n    \"title\": \"shift manager\",\n    \"person\":\n     {\"first_name\": \"Anisha\",\n      \"last_name\": \"Salim\",\n      \"permalink\": \"anisha-salim\"}},\n   {\"is_past\": true,\n    \"title\": \"Store manager\",\n    \"person\":\n     {\"first_name\": \"Fabrice\",\n      \"last_name\": \"Enderlin\",\n      \"permalink\": \"fabrice-enderlin\"}},\n   {\"is_past\": true,\n    \"title\": \"Operations Teams\",\n    \"person\":\n     {\"first_name\": \"Matt\",\n      \"last_name\": \"House\",\n      \"permalink\": \"matt-house\"}},\n   {\"is_past\": true,\n    \"title\": \"Manager of Unique Development\",\n    \"person\":\n     {\"first_name\": \"Kathleen M.\",\n      \"last_name\": \"Keith\",\n      \"permalink\": \"kathleen-m-keith\"}},\n   {\"is_past\": true,\n    \"title\": \"Sr. Marketing Manager\",\n    \"person\":\n     {\"first_name\": \"Suasan\",\n      \"last_name\": \"Boresow\",\n      \"permalink\": \"suasan-boresow\"}},\n   {\"is_past\": true,\n    \"title\": \"Treasury Support Group - Corporate Controller Group\",\n    \"person\":\n     {\"first_name\": \"Matt\",\n      \"last_name\": \"Fumagalli\",\n      \"permalink\": \"matt-fumagalli\"}},\n   {\"is_past\": true,\n    \"title\": \"Leaders In Consumer Electronics, Information Management Systems, Video Surveillance, and Retail Information Systems\",\n    \"person\":\n     {\"first_name\": \"Bill\",\n      \"last_name\": \"Taylor\",\n      \"permalink\": \"bill-taylor\"}},\n   {\"is_past\": true,\n    \"title\": \"Various\",\n    \"person\":\n     {\"first_name\": \"William\",\n      \"last_name\": \"(Bill) M. Wells\",\n      \"permalink\": \"william-bill-m-wells\"}}],\n \"competitions\":\n  [],\n \"providerships\":\n  [{\"title\": \"Commercial Video Advertising Production\",\n    \"is_past\": true,\n    \"provider\":\n     {\"name\": \"Mercury Digital Agency\",\n      \"permalink\": \"mercury-digital-agency\"}}],\n \"total_money_raised\": \"$0\",\n \"funding_rounds\":\n  [],\n \"investments\":\n  [],\n \"acquisition\": null,\n \"acquisitions\":\n  [],\n \"offices\":\n  [{\"description\": \"Corporate Headquarters\",\n    \"address1\": \"2111 McDonald's Dr.\",\n    \"address2\": \"\",\n    \"zip_code\": \"60523\",\n    \"city\": \"Oak Brook\",\n    \"state_code\": \"IL\",\n    \"country_code\": \"USA\",\n    \"latitude\": null,\n    \"longitude\": null}],\n \"milestones\":\n  [],\n \"ipo\": null,\n \"video_embeds\":\n  [],\n \"screenshots\":\n  [],\n \"external_links\":\n  [{\"external_url\": \"http://jobs.mcdonalds.co.uk/\",\n    \"title\": \"Customer Care Jobs\"}],\n \"partners\":\n  []}")

      Net::HTTP.stub(:get_response).and_return(company)
      ny_companies = @companies.get_ny_companies(['mcdonalds'])

      expect(ny_companies).to eq([])
    end
  end
end